---
title: "Siaya County - Household Sample"
author: 'Weekly Statistics'
date: ''
output:
  html_document:
    theme: paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(haven)
library(tidyverse)
library(dygraphs)
covid_weekly <- read_dta("~/Dropbox (Princeton)/GE_Endline2/covid19/data/COVID_AllHHs_outcomes_weekly.dta")

#Grouping vars for graphs
cov <- c("week", "cov1_wins", "cov3_wins", "cov4_wins")
cov <- covid_weekly[cov]

cov1 <- c("week", "cov1_cough_wins", "cov1_fever_wins", "cov1_tired_wins", "cov1_fever_cough_wins")
cov1 <- covid_weekly[cov1]

ckn <- c("week", "ckn2_wins", "ckn3_wins", "ckn4_wins", "ckn5_wins", "ckn6_wins")
ckn <- covid_weekly[ckn]

ckn2 <- c("week", "ckn2_cough_wins", "ckn2_fever_wins", "ckn2_tired_wins", "ckn2_dbreath_wins")
ckn2 <- covid_weekly[ckn2]

ckn6 <- c("week", "ckn6_washhands_wins", "ckn6_sanitizer_wins", "ckn6_stayhome_wins", "ckn6_mask_wins")
ckn6 <- covid_weekly[ckn6]

c <- c("week", "c1_wins", "c3_wins") #, "c3_wins", "c4_wins"
c <- covid_weekly[c]

i <- c("week", "i1_wins", "i2_wins" , "i3_wins") #, "i4_wins", "i5_wins", "i6_wins"  , "i7_wins"
i <- covid_weekly[i]

f1 <- c("week", "f1_h_shortages_wins", "f1_h_price_wins", "f1_h_income_wins")
f1 <- covid_weekly[f1]

f1_d <- c("week", "f1_d_skippedadult_wins", "f1_d_skippedchild_wins")
f1_d <- covid_weekly[f1_d]

f1_meals <- c("week", "f1_meat_wins", "f1_eggs_wins")
f1_meals <- covid_weekly[f1_meals]

net5 <- c("week", "net5_today_wins", "net5_last7_wins", "net5_last14_wins")
net5 <- covid_weekly[net5]

ch <- c("week", "ch1_wins", "ch2_wins", "ch3_wins")
ch <- covid_weekly[ch]

l <- c("week", "l1_wins", "l2_wins", "l3_wins")
l <- covid_weekly[l]

e <- c("week", "e3_wins", "e4_wins")
e <- covid_weekly[e]
```
  


##  {.tabset}

### Consumption

<font size="5">**Weekly consumption per capita (USD, PPP)**</font>
``` {r consumption}
c_g <- dygraph(c, main = "", group = "Siaya County Sample") %>%
  #dySeries("c4_wins", strokeWidth = 6, label = "Total consumption") %>%
  #dySeries("c2_wins", strokeWidth = 4, label = "Food consumption") %>%
  dySeries("c1_wins", strokeWidth = 4, label = "Food expenditure") %>%
  dySeries("c3_wins", strokeWidth = 4, label = "Non-food expenditure") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", label = "USD, PPP", drawGrid = FALSE) %>% 
  dyLegend(width = 200 , labelsSeparateLines = TRUE) %>%
    dyCrosshair(direction = "vertical") %>%
  dyOptions(stackedGraph = TRUE, includeZero = TRUE, axisLineWidth = 4, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
      dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) 
  c_g

```


***  
### Income  
<font size="5">**Earnings per capita (USD, PPP) - past 14 days**</font>
``` {r income}
  i_g <- dygraph(i, main = "") %>%
 # dySeries("i4_wins", strokeWidth = 6, label = "Total household earnings") %>%
 # dySeries("i6_wins", strokeWidth = 4, label = "Net transfers") %>%
 # dySeries("i5_wins", strokeWidth = 4, label = "Support from gov and other entities") %>%
  dySeries("i3_wins", strokeWidth = 4, label = "Wage earnings") %>%
  dySeries("i1_wins", strokeWidth = 4, label = "Ag earnings") %>%
  dySeries("i2_wins", strokeWidth = 4, label = "Self-employment earnings") %>%
  #  dySeries("i7_wins", strokeWidth = 4, label = "Dissaving") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", label = "USD, PPP", drawGrid = FALSE) %>% 
  dyLegend(width = 250, labelsSeparateLines = TRUE) %>%
    dyCSS(textConnection("
.dygraph-legend  { display: all; }
.highlight {
  display: inline;
}
  ")) %>%
  dyOptions(stackedGraph = TRUE, includeZero = TRUE, axisLineWidth = 4, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(5, "Set2")) %>%
    dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3))
i_g
```

***  
### Food Security  
<font size="5">**Number of days experiencing food struggles in the past 7 days**</font>
```{r struggles}
f1_d_g  <- dygraph(f1_d, main = "") %>%
  dySeries("f1_d_skippedadult_wins", strokeWidth = 4, label = "Adults skipped meals") %>%
  dySeries("f1_d_skippedchild_wins", strokeWidth = 4, label = "Children skipped meals") %>%
 # dySeries("f1_d_hungryadult", strokeWidth = 4, label = "Adults gone to bed hungry") %>%
#  dySeries("f1_d_hungrychild", strokeWidth = 4, label = "Children gone to bed hungry") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", drawGrid = FALSE , label = "Number of days") %>% 
  dyOptions(axisLineWidth = 4, includeZero = TRUE,drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
    dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>%
  dyLegend(width = 210, labelsSeparateLines = TRUE) 
f1_d_g
```
    
***  
### Household enterprises  
<font size="5">**Enterprises revenue and profits in the past 14 days**</font>
```{r enterprises}
e_g  <- dygraph(e, main = "") %>%
  dySeries("e3_wins", strokeWidth = 4, label = "Total enterprise revenue") %>%
  dySeries("e4_wins", strokeWidth = 4, label = "Total enterprise profits") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", drawGrid = FALSE , label = "USD, PPP") %>% 
  dyOptions(axisLineWidth = 4, includeZero = TRUE,drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
    dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>%
  dyLegend(width = 200, labelsSeparateLines = TRUE) 
e_g
``` 
  
  ***  

### COVID-19  

  **Behavior Changes**  
    
    
  We ask respondents whether they have changed their behavior in any way since learning about COVID-19, and if so, how has it changed in the last 14 days.  
  
<font size="5">**Reported COVID-19 Behavior Changes**</font>
```{r behavior_changes}
  ckn6_g <- dygraph(ckn6, main = "") %>%
    dySeries("ckn6_washhands_wins", strokeWidth = 4, label = "Hand Washing") %>%
    dySeries("ckn6_mask_wins", strokeWidth = 4, label = "Face Mask") %>%    
    dySeries("ckn6_stayhome_wins", strokeWidth = 4, label = "Stay Home") %>%
    dySeries("ckn6_sanitizer_wins", strokeWidth = 4, label = "Hand Sanitizer") %>%
    dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
    dyAxis("y", drawGrid = FALSE, label = "Percentage of sample") %>% #grid
    dyLegend(width = 580) %>%
    dyOptions(axisLineWidth = 4, includeZero = TRUE, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
    dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>%
    dyEvent(1.7 , "Face masks mandatory", labelLoc = "bottom") %>%
  dyCrosshair(direction = "vertical")
  ckn6_g
```

***  
**Symptoms**  
  
We ask respondents whether they have experienced any illnesses or symptoms of a given list in the past 14 days.  
  
<font size="5">**Reported COVID-19 Symptoms, past 14 days**</font>
``` {r symptoms}
  cov1_g <- dygraph(cov1, main = "") %>% 
  dySeries("cov1_fever_wins", strokeWidth = 4, label = "Fever") %>%
  dySeries("cov1_tired_wins", strokeWidth = 4, label = "Tired") %>%
  dySeries("cov1_cough_wins", strokeWidth = 4, label = "Cough") %>%
  dySeries("cov1_fever_cough_wins", strokeWidth = 4, label = "Fever+Cough") %>%
    dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
    dyAxis("y", drawGrid = FALSE, label = "Percentage of sample") %>% #grid
  dyLegend(width = 500) %>%
  dyOptions(axisLineWidth = 4, includeZero = TRUE, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
    dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3))
  cov1_g
```


***  
**In-person interactions**

We ask: "Taken together, how many people outside this household have you interacted with in-person?"   
  
<font size="5">**Number of in-person interactions (other than HH members)**</font>
```{r interactions}
net5_g  <- dygraph(net5, main = "") %>%
  dySeries("net5_last14_wins", strokeWidth = 4, label = "In the past 14 days") %>%
  dySeries("net5_last7_wins", strokeWidth = 4, label = "In the past 7 days") %>%
  dySeries("net5_today_wins", strokeWidth = 4, label = "Today") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", drawGrid = FALSE, label = "Number of people") %>% 
  dyLegend(width = 500) %>%
     dyCrosshair(direction = "vertical") %>%
 dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>%
  dyOptions(axisLineWidth = 4, includeZero = TRUE, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2"))
net5_g
```

*** 
### Labor Supply

<font size="5">**Weekly labor supply (hours per household member)**</font>
``` {r labor}
l_g <- dygraph(l, main = "", group = "Siaya County Sample") %>%
  dySeries("l1_wins", strokeWidth = 4, label = "Agricultural labor supply") %>%
  dySeries("l2_wins", strokeWidth = 4, label = "Own enterprise labor supply") %>%
  dySeries("l3_wins", strokeWidth = 4, label = "Wage labor supply") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", label = "Hours per HH member", drawGrid = FALSE) %>% 
  dyLegend(width = 550 , labelsSeparateLines = FALSE) %>%
    dyCrosshair(direction = "vertical") %>%
  dyOptions(stackedGraph = TRUE, includeZero = TRUE, axisLineWidth = 4, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2")) %>%
      dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) 
  l_g

```


***  
### Children Education

We ask what has each child been doing over the last 15 minutes, whether the child has done any learning-related activities in the past 24 hours, and if so, what kind of activity.  
  
<font size="5">**Children educational activities**</font>
```{r children}
ch_g  <- dygraph(ch, main = "", group = "Siaya County Sample") %>%
  dySeries("ch2_wins", strokeWidth = 4, label = "In the past 24 hours") %>%
  dySeries("ch3_wins", strokeWidth = 4, label = "Attended school") %>%
  dySeries("ch1_wins", strokeWidth = 4, label = "In the past 15 minutes") %>%
  dyAxis("x", pixelsPerLabel = 100 , drawGrid = FALSE, label = "Weeks") %>% #grid
  dyAxis("y", drawGrid = FALSE, label = "Percentage of sample") %>% 
     dyCrosshair(direction = "vertical") %>%
 dyLegend(width = 550) %>%
  dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>%
  dyOptions(axisLineWidth = 4, drawPoints = TRUE, pointSize = 4, colors = RColorBrewer::brewer.pal(4, "Set2"))
ch_g
```

***   

## {}
      
These data comes from phone survey interviews conducted by [REMIT Kenya](http://remitkenya.co.ke/) in Siaya County, Kenya. We are collecting data for a sample of ~12,000 households in the county, which is representative of the whole population. At the same time, our weekly sampling method assures weekly representativeness of the overall sample.

So far we have interviewed 6,592 households, with the following distribution per week:

| Week	| Dates	| Number of surveys |
|------|:-----:|:---------:|
| Week 1 |	05 April 2020 - 11 April 2020	| 743 |
| Week 2 |	12 April 2020 - 18 April 2020	| 743 |
| Week 3 |	19 April 2020 - 25 April 2020	| 1,477 |
| Week 4 |	26 April 2020 - 02 May 2020	| 1,145 |
| Week 5 |	03 May 2020 - 09 May 2020	| 1,498 |
| Week 6 |	10 May 2020 - 14 May 2020	| 986 |


